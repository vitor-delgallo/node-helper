const VDFileHelper=require("./file.min.js"),os=require("os"),fs=require("fs"),pidusage=require("pidusage");class VDSOHelper{static async getServerStatus(){const e=os.uptime(),s=process.uptime();let i={};try{const e=fs.statSync("/");i={total:VDFileHelper.humanFileSize(e.blksize*e.blocks),free:VDFileHelper.humanFileSize(e.blksize*e.bfree)}}catch(e){i={error:"Unable to retrieve disk usage data."}}const t=os.loadavg()[0],r=os.cpus().length,o=t>r,l=await pidusage(process.pid),u=os.totalmem(),a=os.freemem(),m=u-a,p=m/u*100;return{system:{memory:{total:VDFileHelper.humanFileSize(u),used:VDFileHelper.humanFileSize(m),free:VDFileHelper.humanFileSize(a),usage:p.toFixed(2)+" %"},cpu:{loadAverage:t.toFixed(2),cpuCount:r,overloaded:o},uptime:(e/60/60).toFixed(2)+" hours"},process:{cpu:{usage:l.cpu.toFixed(2)+" %"},memory:{used:VDFileHelper.humanFileSize(l.memory),usage:(l.memory/u*100).toFixed(2)+" %"},uptime:(s/60).toFixed(2)+" minutes"},disk:i}}static getSystemCpuUsage(){return new Promise((e=>{const s=os.cpus();setTimeout((()=>{const i=os.cpus();let t=0,r=0;for(let e=0;e<s.length;e++){const o=s[e].times,l=i[e].times,u=l.idle-o.idle;t+=u,r+=l.user-o.user+(l.nice-o.nice)+(l.sys-o.sys)+(l.irq-o.irq)+u}e(100*(1-t/r))}),500)}))}}module.exports=VDSOHelper;